original_work_dir: ${hydra:runtime.cwd}
data_dir: ${original_work_dir}/data/
print_config: true
ignore_warnings: true
train: true
test: true
seed: 12345
name: MNET
trainer:
  _target_: pytorch_lightning.Trainer
  min_epochs: 1000
  max_epochs: 2000
  accelerator: auto
  gradient_clip_val: 0
  accumulate_grad_batches: 1
  check_val_every_n_epoch: 100
  fast_dev_run: false
datamodule:
  _target_: src.datamodules.aist_datamodule.AISTPPDataModule
  data_path: ${data_dir}AIST++
  music_length: ${model.gen_params.music_length}
  seed_m_length: ${model.gen_params.seed_m_length}
  predict_length: ${model.gen_params.predict_length}
  train_test_split:
  - 1368
  - 40
  batch_size: 10
  num_workers: 10
  pin_memory: true
model:
  _target_: src.models.aist_module.AISTLitModule
  gen_params:
    dim: 512
    depth: 12
    heads: 8
    mlp_dim: 2048
    music_length: 120
    seed_m_length: 60
    predict_length: 20
    rot_6d: true
  dis_params:
    dim: 512
    depth: 8
    heads: 8
    mlp_dim: 2048
    rot_6d: ${model.gen_params.rot_6d}
  loss_params:
    loss_dict:
      l_adv_loss: 1
      l_rec_loss: 1
      l_vet_loss: 1
      l_div_loss: 0.5
      l_sfc_loss: 1
    rot_6d: ${model.gen_params.rot_6d}
    smpl_path: ${data_dir}AIST++/SMPL_DIR
  optimizer:
    type: AdamW
    kwargs:
      lr: 0.0001
      betas:
      - 0.9
      - 0.99
      weight_decay: 0
  scheduler: null
callbacks:
  model_checkpoint:
    _target_: pytorch_lightning.callbacks.ModelCheckpoint
    dirpath: checkpoints/
    filename: null
    save_last: true
    save_top_k: -1
    every_n_train_steps: 30000
  dance_generation:
    _target_: src.callbacks.dance_generation.DanceGeneration
    data_path: ${datamodule.data_path}
    data_name: gBR_sBM_cAll_d04_mBR0_ch01.pkl
    seed_m_length: ${model.gen_params.seed_m_length}
    play_time: 10
    num_sample: 3
    smpl_path: ${data_dir}AIST++/SMPL_DIR
logger:
  tensorboard:
    _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger
    save_dir: tensorboard/
    name: ${name}
    log_graph: false
    default_hp_metric: false
